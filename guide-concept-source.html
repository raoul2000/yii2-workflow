<!DOCTYPE html>
<html lang="en-US">
<head>
    <meta charset="UTF-8"/>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="language" content="en" />
        <link href="./assets/ca9878b0/css/bootstrap.css" rel="stylesheet">
<link href="./assets/e4a78afa/style.css" rel="stylesheet">
<script src="./assets/dac0333d/jquery.js"></script>
<script src="./assets/ca9878b0/js/bootstrap.js"></script>
<script src="./assets/23719cdf/jssearch.js"></script>    <title>Workflow Source - Key Concepts - Yii2-Workflow Guide</title>
</head>
<body>

<div class="wrap">
    <nav id="w16" class="navbar-inverse navbar-fixed-top navbar" role="navigation"><div class="navbar-header"><button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#w16-collapse"><span class="sr-only">Toggle navigation</span>
<span class="icon-bar"></span>
<span class="icon-bar"></span>
<span class="icon-bar"></span></button><a class="navbar-brand" href="./index.html">Yii2-Workflow Guide</a></div><div id="w16-collapse" class="collapse navbar-collapse"><ul id="w17" class="navbar-nav nav"><li><a href="./index.html">Class reference</a></li>
<li><a href="./guide-README.html">Guide</a></li></ul><div class="navbar-form navbar-left" role="search">
  <div class="form-group">
    <input id="searchbox" type="text" class="form-control" placeholder="Search">
  </div>
</div>
</div></nav>
    <div id="search-resultbox" style="display: none;" class="modal-content">
        <ul id="search-results">
        </ul>
    </div>

    
<div class="row">
    <div class="col-md-2">
                <div id="navigation" class="list-group"><a class="list-group-item" href="#navigation-12" data-toggle="collapse" data-parent="#navigation">Introduction <b class="caret"></b></a><div id="navigation-12" class="submenu panel-collapse collapse"><a class="list-group-item" href="./guide-intro-workflow.html">About Workflows</a>
<a class="list-group-item" href="./guide-intro-installation.html">Installing yii2-workflow</a>
<a class="list-group-item" href="./guide-intro-upgrade-from-v1.html">Upgrading from Version 1.x</a></div>
<a class="list-group-item active" href="#navigation-13" data-toggle="collapse" data-parent="#navigation">Key Concepts <b class="caret"></b></a><div id="navigation-13" class="submenu panel-collapse collapse in"><a class="list-group-item" href="./guide-concept-overview.html">Overview</a>
<a class="list-group-item active" href="./guide-concept-source.html">Workflow Source</a>
<a class="list-group-item" href="./guide-concept-events.html">Workflow Events</a>
<a class="list-group-item" href="./guide-concept-validation.html">Workflow Driven Attribute Validation</a></div>
<a class="list-group-item" href="#navigation-14" data-toggle="collapse" data-parent="#navigation">Workflow Components <b class="caret"></b></a><div id="navigation-14" class="submenu panel-collapse collapse"><a class="list-group-item" href="./guide-workflow-behavior.html">Behavior</a>
<a class="list-group-item" href="./guide-source-file.html">File Source</a></div>
<a class="list-group-item" href="#navigation-15" data-toggle="collapse" data-parent="#navigation">Special topics <b class="caret"></b></a><div id="navigation-15" class="submenu panel-collapse collapse"><a class="list-group-item" href="./guide-special-cookbook.html">Cookbook</a></div></div>    </div>
    <div class="col-md-9 guide-content" role="main">
        <h1>Workflow Source <a href="#workflow-source" id="workflow-source" class="hashlink">&para;</a></h1><p>The <em>Workflow Source</em> is a Yii2 component dedicated to read the persistent representation of a workflow and provide on demand to the
<em>SimpleWorkflowBehavior</em>, its memory representation in terms of PHP objects.</p>
<p>The main Workflow Source component included in the <em>SimpleWorkflow</em> package is <code>raoul2000\workflow\source\file\WorkflowFileSource</code>. It is designed
to process workflow definition stored in a file as a regular PHP Array, a PHP class definition or a Graphml file ( for a detail description, refer
to <a href="guide-source-file.html">Workflow File Source Component</a>).</p>
<p>Note that it is possible that in the future, other workflow source component are provided like for instance a <em>WorkflowDbSource</em> that would
read from a database. </p>
<h2>About Workflow Objects <a href="#about-workflow-objects" id="about-workflow-objects" class="hashlink">&para;</a></h2><p>The <em>SimpleWorkflow</em> manipulates objects to manage workflows. There are 3 basic types of objects that you will meet sooner or later. They are
all part of the <code>raoul2000\workflow\base</code> namespace:</p>
<ul>
<li><code>Status</code> : implements a status in a workflow</li>
<li><code>Transition</code> : implemented a directed transition between 2 statuses</li>
<li><code>Workflow</code> : implement a collection of statuses and transitions</li>
</ul>
<p>The main purpose of a Workflow Source component is to turn a workflow definition into a set of Status, Transition and Workflow objects. </p>
<h2>Component registration <a href="#component-registration" id="component-registration" class="hashlink">&para;</a></h2><p>When the <em>SimpleWorkflowBehavior</em> is initialized, it tries to get a reference to the <em>Workflow Source Component</em> to use. By default
this component is assumed to have the id <strong>workflowSource</strong>. If no such component is available, the <em>SimpleWorkflowBehavior</em> will <strong>create one</strong>,
with the type <code>raoul2000\workflow\source\file\WorkflowFileSource</code> (default) and registers it in the Yii2 application, so to make it 
available to other instances of <em>SimpleWorkflowBehavior</em>.</p>
<p>This implies that, unless specified otherwise, by default, all <em>SimpleWorkflowBehavior</em> are sharing <strong>the same Workflow Source component</strong>.</p>
<p>If you're not familiar with "application Component", please refer to the "<a href="http://www.yiiframework.com/doc-2.0/guide-structure-application-components.html">Definitive Guide to Yii2</a>"</p>
<p>To summarize :</p>
<ul>
<li><strong>workflowSource</strong> : default Id of the workflow source component used by the <em>SimpleWorkflowBehavior</em></li>
<li><strong>\raoul2000\workflow\source\file\WorkflowFileSource</strong> : default workflow source component type </li>
</ul>
<p>If for instance you want to use another Workflow Source Component instead of the default one, you must configure it like you would do for 
any other Yii2 component and use the expected default Id.</p>
<pre><code class="language-php"><span style="color: #0000BB">$config&nbsp;</span><span style="color: #007700">=&nbsp;[<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">//&nbsp;....<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #DD0000">'components'&nbsp;</span><span style="color: #007700">=&gt;&nbsp;[<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #DD0000">'workflowSource'&nbsp;</span><span style="color: #007700">=&gt;&nbsp;[<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #DD0000">'class'&nbsp;</span><span style="color: #007700">=&gt;&nbsp;</span><span style="color: #DD0000">'\my\own\component\SuperCoolWorkflowSource'</span><span style="color: #007700">,<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;]<br />&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">//&nbsp;...</span></code></pre>
<p>With this configuration, all <em>SimpleWorkflowBehavior</em> are going to use your <em>SuperCoolWorkflowSource</em> to get Status, Transition and Workflow objects.</p>
<p>Another option is to mix Workflow Source Components and for instance use the default one with all models except for a particular one. To achieve this,
simply configure your custom Workflow Source Component under a custom Id. Let's see that on an example: </p>
<blockquote><p>Let's assume that you have developped a super cool workflow source component, able to read workflow definition from a satelite data stream, live
from deep outer space (if you did so, pull requests are welcome !!). You want to use this source only for the <em>SpaceShip</em> model in your app, leaving all other models
with the default source (PHP class). </p>
</blockquote>
<p>To do so, first declare your workflow source as a Yii2 component : </p>
<pre><code class="language-php"><span style="color: #0000BB">$config&nbsp;</span><span style="color: #007700">=&nbsp;[<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">//&nbsp;....<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #DD0000">'components'&nbsp;</span><span style="color: #007700">=&gt;&nbsp;[<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">//&nbsp;declare&nbsp;your&nbsp;source&nbsp;component&nbsp;under&nbsp;a&nbsp;custom&nbsp;id&nbsp;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #DD0000">'mySpaceSource'&nbsp;</span><span style="color: #007700">=&gt;&nbsp;[<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #DD0000">'class'&nbsp;</span><span style="color: #007700">=&gt;&nbsp;</span><span style="color: #DD0000">'\my\own\component\AlienWorkflowSource'</span><span style="color: #007700">,<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;]<br />&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">//&nbsp;...</span></code></pre>
<p>And then use the component <em>mySpaceSource</em> as Workflow source for the <em>SpaceShip</em> model only :</p>
<pre><code class="language-php"><span style="color: #0000BB"></span><span style="color: #007700">namespace&nbsp;</span><span style="color: #0000BB">app</span><span style="color: #007700">\</span><span style="color: #0000BB">models</span><span style="color: #007700">;<br />class&nbsp;</span><span style="color: #0000BB">SpaceShip&nbsp;</span><span style="color: #007700">extends&nbsp;\</span><span style="color: #0000BB">yii</span><span style="color: #007700">\</span><span style="color: #0000BB">db</span><span style="color: #007700">\</span><span style="color: #0000BB">ActiveRecord<br /></span><span style="color: #007700">{<br />&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;function&nbsp;</span><span style="color: #0000BB">behaviors</span><span style="color: #007700">()<br />&nbsp;&nbsp;&nbsp;&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;[<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #DD0000">'class'&nbsp;</span><span style="color: #007700">=&gt;&nbsp;\</span><span style="color: #0000BB">raoul2000</span><span style="color: #007700">\</span><span style="color: #0000BB">workflow</span><span style="color: #007700">\</span><span style="color: #0000BB">base</span><span style="color: #007700">\</span><span style="color: #0000BB">SimpleWorkflowBehavior</span><span style="color: #007700">::</span><span style="color: #0000BB">className</span><span style="color: #007700">(),<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">//&nbsp;SpaceShip&nbsp;will&nbsp;use&nbsp;a&nbsp;specific&nbsp;Workflow&nbsp;Source&nbsp;Component<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;All&nbsp;other&nbsp;models&nbsp;are&nbsp;using&nbsp;the&nbsp;default&nbsp;one<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #DD0000">'source'&nbsp;</span><span style="color: #007700">=&gt;&nbsp;</span><span style="color: #DD0000">'mySpaceSource'<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">]<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;];<br />&nbsp;&nbsp;&nbsp;&nbsp;}<br />}</span></code></pre>
<h2>Implementing Your Own Workflow source <a href="#implementing-your-own-workflow-source" id="implementing-your-own-workflow-source" class="hashlink">&para;</a></h2><p>You can create your own Workflow Source Component by implementing the <code>\raoul2000\workflow\source\IWorkflowSource</code> interface.</p>
        <div class="toplink"><a href="#" class="h1" title="go to top"><span class="glyphicon glyphicon-arrow-up"></a></div>
    </div>
</div>


</div>

<footer class="footer">
        <p class="pull-right"><small>Page generated on Mon, 26 Oct 2015 21:03:20 +0000</small></p>
    Powered by <a href="http://www.yiiframework.com/" rel="external">Yii Framework</a></footer>

<script type="text/javascript">jQuery(document).ready(function () {
    var shiftWindow = function () { scrollBy(0, -50) };
    if (location.hash) shiftWindow();
    window.addEventListener("hashchange", shiftWindow);
var element = document.createElement("script");
element.src = "./jssearch.index.js";
document.body.appendChild(element);

var searchBox = $('#searchbox');

// search when typing in search field
searchBox.on("keyup", function(event) {
    var query = $(this).val();

    if (query == '' || event.which == 27) {
        $('#search-resultbox').hide();
        return;
    } else if (event.which == 13) {
        var selectedLink = $('#search-resultbox a.selected');
        if (selectedLink.length != 0) {
            document.location = selectedLink.attr('href');
            return;
        }
    } else if (event.which == 38 || event.which == 40) {
        $('#search-resultbox').show();

        var selected = $('#search-resultbox a.selected');
        if (selected.length == 0) {
            $('#search-results').find('a').first().addClass('selected');
        } else {
            var next;
            if (event.which == 40) {
                next = selected.parent().next().find('a').first();
            } else {
                next = selected.parent().prev().find('a').first();
            }
            if (next.length != 0) {
                var resultbox = $('#search-results');
                var position = next.position();

//              TODO scrolling is buggy and jumps around
//                resultbox.scrollTop(Math.floor(position.top));
//                console.log(position.top);

                selected.removeClass('selected');
                next.addClass('selected');
            }
        }

        return;
    }
    $('#search-resultbox').show();
    $('#search-results').html('<li><span class="no-results">No results</span></li>');

    var result = jssearch.search(query);

    if (result.length > 0) {
        var i = 0;
        var resHtml = '';

        for (var key in result) {
            if (i++ > 20) {
                break;
            }
            resHtml = resHtml +
            '<li><a href="' + result[key].file.u.substr(3) +'"><span class="title">' + result[key].file.t + '</span>' +
            '<span class="description">' + result[key].file.d + '</span></a></li>';
        }
        $('#search-results').html(resHtml);
    }
});

// hide the search results on ESC
$(document).on("keyup", function(event) { if (event.which == 27) { $('#search-resultbox').hide(); } });
// hide search results on click to document
$(document).bind('click', function (e) { $('#search-resultbox').hide(); });
// except the following:
searchBox.bind('click', function(e) { e.stopPropagation(); });
$('#search-resultbox').bind('click', function(e) { e.stopPropagation(); });

});</script></body>
</html>
